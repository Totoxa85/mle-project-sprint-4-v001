# Музыкальные Рекомендации

Этот проект представляет собой систему рекомендаций для музыкальных треков. Система использует персонализированные рекомендации, если они доступны, и в противном случае предоставляет топ-популярные треки. Для онлайн-рекомендаций система использует историю прослушивания пользователя и схожие треки.

## Структура проекта

- `recommendations_service.py`: Сервис рекомендаций.
- `features_service.py`: Сервис поиска схожих треков.
- `history_service.py`: Сервис истории прослушивания пользователей.
- `test_recommendations_service.py`: Тесты для сервиса рекомендаций.

#### Файлы нужно скачать из S3 бакета `s3-student-mle-20241219-9c48261c0c`
- путь до файлов внтури бакета `recsys/recommendations`
- создать в проеуте папку `recsys/recommendations` и положить их туда

## Установка и запуск

### Предварительные требования

- Python 3.8 или выше
- `pip` для установки пакетов
- Доступ к интернету для установки зависимостей

### Установка зависимостей

Создайте и активируйте виртуальное окружение:

```bash
python -m venv venv
source venv/bin/activate  
# Для Windows используйте 
venv\Scripts\activate
```
# Установите необходимые пакеты:

```bash
pip install fastapi uvicorn pandas requests pytest
```
# Запуск сервисов
## Запустите каждый из сервисов отдельно:

```bash
# В отдельном терминале для каждого сервиса
uvicorn recommendations_service:app --reload --host 127.0.0.1 --port 8000

uvicorn features_service:app --reload --host 127.0.0.1 --port 8010

uvicorn history_service:app --reload --host 127.0.0.1 --port 8020
```
# API
## Эндпоинты
### Персональные рекомендации (Оффлайн)
- URL: `/recommendations_offline`
- Метод: `POST`
- Параметры:
    - user_id (int): ID пользователя
    - k (int): Количество рекомендаций (по умолчанию 100)
- Возвращает: JSON с персональными рекомендациями
### Онлайн рекомендации
- URL: `/recommendations_online`
- Метод: `POST`
- Параметры:
    - user_id (int): ID пользователя
    - k (int): Количество рекомендаций (по умолчанию 100)
- Возвращает: JSON с онлайн рекомендациями
### Комбинированные рекомендации
- URL: `/recommendations`
- Метод: `POST`
- Параметры:
    - user_id (int): ID пользователя
    - k (int): Количество рекомендаций (по умолчанию 100)
- Возвращает: JSON с комбинированными рекомендациями
# Тестирование
## Для тестирования используется pytest. Запустите тесты с помощью команды:

```bash
pytest test_recommendations_service.py
```
`Логи тестов будут сохранены в файл test_service.log.`